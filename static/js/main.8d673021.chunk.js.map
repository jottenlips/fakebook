{"version":3,"sources":["util/songParser.js","util/composeMidiFile.js","util/playMidi.js","samples/SoundFonts.js","components/Fakebook.jsx","util/withSynth.jsx","components/Box.jsx","components/ThreeDCanvas.jsx","components/MidiIn.jsx","components/MidiOut.jsx","components/Code.jsx","util/withMidi.jsx","Routes.jsx","App.jsx","serviceWorker.js","index.js"],"names":["parseSong","_ref","chords","octave","loop","measures","repeat","join","split","parsedChords","parseChords","appendProgressionDetails","map","measure","filter","chord","length","notes","tonal","note","index","concat","spreadOctave","duration","composeMidiFile","tempo","bassLine","arguments","undefined","track","MidiWriter","Track","bassTrack","NoteEvent","pitch","slice","Infinity","event","addEvent","generateBassLine","setTempo","write","Writer","console","log","dataUri","getRandomNote","weightedNotes","distributeNoteProbability","reverse","w2","w3","Math","floor","random","addRandomNoteToTrack","charAt","Array","fill","ac","AudioContext","Soundfont","require","playMidi","Object","asyncToGenerator","regenerator_default","a","mark","_callee","instrument","wrap","_context","prev","next","then","Player","MidiPlayer","time","currentTime","name","play","noteName","gain","velocity","loadDataUri","stop","_x","_x2","apply","this","playMidiThroughOutput","_ref2","_callee2","output","_context2","playNote","stopNote","_x3","_x4","soundFonts","Space","styled","div","_templateObject","Text","text","_templateObject2","Options","_templateObject3","JazzText","textarea","_templateObject4","props","_useState","useState","_useState2","slicedToArray","setChords","_useState3","_useState4","_useState5","_useState6","setLoop","_useState7","_useState8","bass","setBass","_useState9","_useState10","file","setFile","_useState11","_useState12","setInstrument","react_default","createElement","style","width","height","alignItems","paddingTop","onSubmit","e","allChords","preventDefault","flatten","midiDataUri","handleSubmit","value","onChange","target","type","font","href","_templateObject5","tremolo","Tone","Tremolo","start","withSynth","Cmp","synth","PolySynth","oscillator","modulationType","modulationIndex","harmonicity","envelope","attack","decay","sustain","release","chain","Master","fmSynth","FMSynth","toMaster","assign","children","Box","mesh","useRef","hovered","setHover","active","setActive","activeNote","setActiveNote","cutoffValue","setCutoffValue","midiIn","addListener","useEffect","set","detune","removeListener","useFrame","current","rotation","x","y","includes","activationNotes","position","z","rotationY","ref","scale","onClick","ceil","noteFromRotation","triggerAttackRelease","midiOut","onPointerOver","onPointerOut","attach","args","color","SynthBox","ThreeDCanvas","web","marginLeft","SmallCanvas","MidiIn","justifyContent","midiIns","input","_midiInput","id","setMidiInId","ThreeDCanvas_ThreeDCanvas","noteEvent","MidiText","MidiOut_templateObject","MidiOut_templateObject2","MidiOut_templateObject3","MidiOut_templateObject4","MidiOut","noteBoxes","setNoteBoxes","Fragment","midiOuts","_midiOutput","setMidiOutId","MidiOut_Options","MidiOut_Text","MidiOut_Space","i","Box_Box","key","Code","padding","CodeTitle","CodeSnippet","CodeText","ThreeDCanvas_SmallCanvas","whiteSpace","textAlign","Code_templateObject","Code_templateObject2","Code_templateObject3","withMidi","compose","midiOutId","setMidiOut","setMidiIn","midiInId","setMidiOuts","_useState13","_useState14","setMidiIns","WebMidi","enable","inputs","outputs","getInputById","getOutputById","SideNav","Routes_templateObject","react_router_dom","basename","flexDirection","to","react_router","path","components_Fakebook","MidiIn_MidiIn","components_MidiOut","Code_Code","component","Fakebook","App","className","src_Routes","Boolean","window","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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vC,GACnCM,QAAQC,IAAIkD,GACZ,IAAMhB,EAAOnB,EAAGoB,YAChBpC,QAAQC,IAAIP,GACG,YAAfA,EAAM2C,MAAsBc,EACxBA,EAAOE,SAAS3D,EAAM6C,SAAU,MAAO,CAAEJ,UACzCgB,EAAOG,SAAS5D,EAAM6C,SAAU,MAAO,CAAEJ,KAAM,SAC/CnC,QAAQC,IAAIP,MAEXgD,YAAYxC,GACnB+B,EAAOK,OAX4B,wBAAAc,EAAAT,SAAAO,MAAH,gBAAAK,EAAAC,GAAA,OAAAP,EAAAH,MAAAC,KAAA/D,YAAA,UCvBrByE,EAAa,CACxB,YACA,gBACA,uBACA,wBACA,wBACA,QACA,WACA,WACA,UACA,QACA,eACA,UACA,aACA,eACA,gBACA,eACA,wBACA,UACA,QACA,aACA,eACA,WACA,WACA,aACA,oBACA,gBACA,WACA,uBACA,qBACA,uBACA,wBACA,uBACA,wBACA,mBACA,mBACA,eACA,SACA,QACA,cACA,gBACA,YACA,kBACA,eACA,kBACA,kBACA,eACA,cACA,aACA,eACA,oBACA,mBACA,UACA,YACA,cACA,aACA,kBACA,UACA,OACA,gBACA,kBACA,kBACA,eACA,iBACA,eACA,gBACA,oBACA,UACA,cACA,YACA,gBACA,OACA,UACA,gBACA,kBACA,oBACA,gBACA,aACA,kBACA,cACA,cACA,iBACA,aACA,cACA,YACA,mBACA,UACA,oBACA,WACA,aACA,iBACA,aACA,WACA,aACA,WACA,SACA,QACA,cACA,cACA,cACA,cACA,oBACA,oBACA,eACA,eACA,gBACA,gBACA,cACA,aACA,kBACA,kBACA,aACA,kBACA,iBACA,YACA,UACA,cACA,kBACA,WACA,UACA,OACA,gBACA,aACA,QACA,SACA,aACA,UACA,YACA,yhBCxHF,IAmGMC,EAAQC,IAAOC,IAAVC,KAGLC,EAAOH,IAAOI,KAAVC,KAIJC,EAAUN,IAAOC,IAAVM,KAKPC,EAAWR,IAAOS,SAAVC,KAMCV,cApGE,SAAAW,GAAS,IAAAC,EACIC,mBAC1B,8JAFsBC,EAAApD,OAAAqD,EAAA,EAAArD,CAA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","file":"static/js/main.8d673021.chunk.js","sourcesContent":["import * as tonal from \"tonal\";\nimport { repeat } from \"ramda\";\n\nexport const parseSong = ({ chords, octave, loop }) => {\n  const loopedChords = repeat(chords, loop).join(\"|\");\n  const measures = loopedChords.split(\"|\");\n  const parsedChords = parseChords(measures);\n  const song = appendProgressionDetails(parsedChords, octave);\n  return song;\n};\n\nconst parseChords = measures => {\n  return measures\n    .map(measure => measure.split(\" \"))\n    .map(measure => measure.filter(chord => chord.length > 0));\n};\n\nconst spreadOctave = index => (index % 2 === 0 ? 1 : 0);\n\nconst appendProgressionDetails = (chords, octave) => {\n  return chords.map(measure =>\n    measure.map(chord => ({\n      notes: tonal.Chord.notes(chord).map(\n        (note, index) => `${note}${octave + spreadOctave(index)}`\n      ),\n      octave,\n      chord,\n      duration: measure.length > 1 ? `2` : `1`\n    }))\n  );\n};\n","import { slice, concat, reverse } from \"ramda\";\n\nimport MidiWriter from \"midi-writer-js\";\n\nexport const composeMidiFile = (chords, tempo, bassLine = false) => {\n  const track = new MidiWriter.Track();\n  const bassTrack = new MidiWriter.Track();\n\n  const chordEvents = chords.map(chord =>\n    // half length chord\n    chord.duration === \"2\"\n      ? new MidiWriter.NoteEvent({\n          pitch: slice(1, Infinity, chord.notes),\n          duration: \"2\"\n        })\n      : // full length chord\n        new MidiWriter.NoteEvent({\n          pitch: slice(1, Infinity, chord.notes),\n          duration: \"1\"\n        })\n  );\n  chordEvents.map(event => track.addEvent(event));\n\n  bassLine &&\n    chords.map(chord => {\n      generateBassLine(chord, bassTrack);\n    });\n\n  track.setTempo(tempo || 120);\n  const write = new MidiWriter.Writer([track, bassTrack]);\n  console.log(write.dataUri());\n  return write.dataUri();\n};\n\nconst getRandomNote = notes => {\n  //root note most probable\n  const weightedNotes = distributeNoteProbability(reverse(notes));\n  // then 3rd\n  const w2 = distributeNoteProbability(weightedNotes);\n  // then 5th\n  const w3 = distributeNoteProbability(w2);\n  return w3[Math.floor(Math.random() * w3.length)];\n};\n\nconst distributeNoteProbability = notes =>\n  concat(notes, slice(1, Infinity, notes));\n\nconst addRandomNoteToTrack = (chord, track, length) => {\n  track.addEvent(\n    new MidiWriter.NoteEvent({\n      pitch: `${getRandomNote(chord.notes).charAt(0)}2`,\n      duration: length\n    })\n  );\n};\n\nconst generateBassLine = (chord, track) => {\n  return chord.duration === \"2\"\n    ? new Array(2).fill().map(() => addRandomNoteToTrack(chord, track, \"4\"))\n    : new Array(4).fill().map(() => addRandomNoteToTrack(chord, track, \"4\"));\n};\n","import MidiPlayer from \"midi-player-js\";\n\nconst ac = new AudioContext();\n\nconst Soundfont = require(\"soundfont-player\");\n// https://github.com/gleitz/midi-js-soundfonts\nexport const playMidi = async (dataUri, instrument) => {\n  Soundfont.instrument(\n    ac,\n    `https://raw.githubusercontent.com/gleitz/midi-js-soundfonts/gh-pages/FatBoy/${instrument}-mp3.js`\n  ).then(instrument => {\n    const Player = new MidiPlayer.Player(event => {\n      const time = ac.currentTime;\n      console.log(event);\n      event.name === \"Note on\"\n        ? instrument.play(event.noteName, time, { gain: event.velocity / 4 })\n        : console.log(event);\n    });\n    Player.loadDataUri(dataUri);\n    Player.play();\n  });\n};\n\nexport const playMidiThroughOutput = async (dataUri, output) => {\n  const Player = new MidiPlayer.Player(event => {\n    console.log(output);\n    const time = ac.currentTime;\n    console.log(event);\n    event.name === \"Note on\" && output\n      ? output.playNote(event.noteName, \"all\", { time }) &&\n        output.stopNote(event.noteName, \"all\", { time: \"+500\" })\n      : console.log(event);\n  });\n  Player.loadDataUri(dataUri);\n  Player.play();\n};\n","export const soundFonts = [\n  \"accordion\",\n  \"acoustic_bass\",\n  \"acoustic_grand_piano\",\n  \"acoustic_guitar_nylon\",\n  \"acoustic_guitar_steel\",\n  \"agogo\",\n  \"alto_sax\",\n  \"applause\",\n  \"bagpipe\",\n  \"banjo\",\n  \"baritone_sax\",\n  \"bassoon\",\n  \"bird_tweet\",\n  \"blown_bottle\",\n  \"brass_section\",\n  \"breath_noise\",\n  \"bright_acoustic_piano\",\n  \"celesta\",\n  \"cello\",\n  \"choir_aahs\",\n  \"church_organ\",\n  \"clarinet\",\n  \"clavinet\",\n  \"contrabass\",\n  \"distortion_guitar\",\n  \"drawbar_organ\",\n  \"dulcimer\",\n  \"electric_bass_finger\",\n  \"electric_bass_pick\",\n  \"electric_grand_piano\",\n  \"electric_guitar_clean\",\n  \"electric_guitar_jazz\",\n  \"electric_guitar_muted\",\n  \"electric_piano_1\",\n  \"electric_piano_2\",\n  \"english_horn\",\n  \"fiddle\",\n  \"flute\",\n  \"french_horn\",\n  \"fretless_bass\",\n  \"fx_1_rain\",\n  \"fx_2_soundtrack\",\n  \"fx_3_crystal\",\n  \"fx_4_atmosphere\",\n  \"fx_5_brightness\",\n  \"fx_6_goblins\",\n  \"fx_7_echoes\",\n  \"fx_8_scifi\",\n  \"glockenspiel\",\n  \"guitar_fret_noise\",\n  \"guitar_harmonics\",\n  \"gunshot\",\n  \"harmonica\",\n  \"harpsichord\",\n  \"helicopter\",\n  \"honkytonk_piano\",\n  \"kalimba\",\n  \"koto\",\n  \"lead_1_square\",\n  \"lead_2_sawtooth\",\n  \"lead_3_calliope\",\n  \"lead_4_chiff\",\n  \"lead_5_charang\",\n  \"lead_6_voice\",\n  \"lead_7_fifths\",\n  \"lead_8_bass__lead\",\n  \"marimba\",\n  \"melodic_tom\",\n  \"music_box\",\n  \"muted_trumpet\",\n  \"oboe\",\n  \"ocarina\",\n  \"orchestra_hit\",\n  \"orchestral_harp\",\n  \"overdriven_guitar\",\n  \"pad_1_new_age\",\n  \"pad_2_warm\",\n  \"pad_3_polysynth\",\n  \"pad_4_choir\",\n  \"pad_5_bowed\",\n  \"pad_6_metallic\",\n  \"pad_7_halo\",\n  \"pad_8_sweep\",\n  \"pan_flute\",\n  \"percussive_organ\",\n  \"piccolo\",\n  \"pizzicato_strings\",\n  \"recorder\",\n  \"reed_organ\",\n  \"reverse_cymbal\",\n  \"rock_organ\",\n  \"seashore\",\n  \"shakuhachi\",\n  \"shamisen\",\n  \"shanai\",\n  \"sitar\",\n  \"slap_bass_1\",\n  \"slap_bass_2\",\n  \"soprano_sax\",\n  \"steel_drums\",\n  \"string_ensemble_1\",\n  \"string_ensemble_2\",\n  \"synth_bass_1\",\n  \"synth_bass_2\",\n  \"synth_brass_1\",\n  \"synth_brass_2\",\n  \"synth_choir\",\n  \"synth_drum\",\n  \"synth_strings_1\",\n  \"synth_strings_2\",\n  \"taiko_drum\",\n  \"tango_accordion\",\n  \"telephone_ring\",\n  \"tenor_sax\",\n  \"timpani\",\n  \"tinkle_bell\",\n  \"tremolo_strings\",\n  \"trombone\",\n  \"trumpet\",\n  \"tuba\",\n  \"tubular_bells\",\n  \"vibraphone\",\n  \"viola\",\n  \"violin\",\n  \"voice_oohs\",\n  \"whistle\",\n  \"woodblock\",\n  \"xylophone\"\n];\n","import React, { useState } from \"react\";\nimport { parseSong } from \"../util/songParser\";\nimport { composeMidiFile } from \"../util/composeMidiFile\";\nimport { flatten } from \"ramda\";\nimport { playMidi } from \"../util/playMidi\";\nimport styled from \"styled-components\";\nimport { soundFonts } from \"../samples/SoundFonts\";\n\nconst handleSubmit = ({\n  e,\n  allChords,\n  tempo,\n  instrument,\n  loop,\n  bass,\n  setFile\n}) => {\n  e.preventDefault();\n  const chords = flatten(parseSong({ chords: allChords, octave: 4, loop }));\n  console.log(chords, \":::CHORDS\");\n  const midiDataUri = composeMidiFile(chords, tempo, bass);\n  setFile(midiDataUri);\n  playMidi(midiDataUri, instrument);\n};\n\nconst Fakebook = props => {\n  const [chords, setChords] = useState(\n    \"BMaj7 D7 | GMaj7 Bb7 | EbMaj7 | Am7 D7 | GMaj7 Bb7 | EbMaj7 F#7 | BMaj7| Fm7 Bb7 | EbMaj7 | Am7 D7 | GMaj7 | C#m7 F#7 | BMaj7 | Fm7 Bb7| EbMaj7 | C#m7 F#7\"\n  );\n  const [tempo, setTempo] = useState(240);\n  const [loop, setLoop] = useState(1);\n  const [bass, setBass] = useState(false);\n  const [file, setFile] = useState();\n\n  const [instrument, setInstrument] = useState(\"marimba\");\n\n  return (\n    <div\n      style={{\n        width: \"100vh\",\n        height: \"100vh\",\n        alignItems: \"center\",\n        paddingTop: 100\n      }}\n    >\n      <form\n        onSubmit={e =>\n          handleSubmit({\n            e,\n            allChords: chords,\n            tempo,\n            instrument,\n            loop,\n            bass,\n            setFile\n          })\n        }\n      >\n        <JazzText value={chords} onChange={e => setChords(e.target.value)} />\n        <Options>\n          <Text>Tempo:</Text>\n          <input\n            value={tempo}\n            type=\"number\"\n            onChange={e => {\n              setTempo(e.target.value);\n            }}\n          />\n          <Space />\n\n          <Text>Repeat:</Text>\n          <input\n            value={loop}\n            type=\"number\"\n            onChange={e => {\n              setLoop(e.target.value);\n            }}\n          />\n          <Space />\n\n          <Text>Instrument:</Text>\n\n          <select\n            value={instrument}\n            onChange={e => setInstrument(e.target.value)}\n          >\n            {soundFonts.map(font => (\n              <option>{font}</option>\n            ))}\n          </select>\n          <Space />\n          <Text>Bassline:</Text>\n          <select value={bass} onChange={e => setBass(e.target.value)}>\n            <option value={true}>{\"true\"}</option>\n            <option value={false}>{\"false\"}</option>\n          </select>\n          <Space />\n          <input type=\"submit\" value=\"Play\" />\n          <Space />\n          <Space />\n          <a href={file}>Download MIDI</a>\n        </Options>\n      </form>\n    </div>\n  );\n};\n\nconst Space = styled.div`\n  padding: 20;\n`;\nconst Text = styled.text`\n  font-size: 12pt;\n`;\n\nconst Options = styled.div`\n  justify-content: space-between;\n  flex-direction: column;\n  height: 100px;\n`;\nconst JazzText = styled.textarea`\n  font-size: 32pt;\n  width: 800px;\n  height: 400px;\n`;\n\nexport default styled(Fakebook)``;\n","import React from \"react\";\nimport Tone from \"tone\";\nvar tremolo = new Tone.Tremolo().start();\n\nexport const withSynth = Cmp => props => {\n  const synth = new Tone.PolySynth({\n    oscillator: {\n      type: \"fmsquare\",\n      modulationType: \"sawtooth\",\n      modulationIndex: 3,\n      harmonicity: 3.4\n    },\n\n    envelope: {\n      attack: 0.001,\n      decay: 0.1,\n      sustain: 0.1,\n      release: 0.1\n    }\n  }).chain(tremolo, Tone.Master);\n\n  const fmSynth = new Tone.FMSynth().toMaster();\n\n  return (\n    <Cmp synth={synth} fmSynth={fmSynth} {...props}>\n      {props.children}\n    </Cmp>\n  );\n};\n","import React, { useRef, useState, useEffect } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\nimport { withSynth } from \"../util/withSynth\";\nimport { length } from \"ramda\";\n\nconst noteFromRotation = (rotation, notes) => {\n  const index = Math.ceil(rotation * 5) % length(notes);\n  console.log(notes[index]);\n  return notes[index];\n};\n\nexport const Box = props => {\n  // This reference will give us direct access to the mesh\n  const mesh = useRef();\n\n  // Set up state for the hovered and active state\n  const [hovered, setHover] = useState(false);\n  const [active, setActive] = useState(false);\n  const [activeNote, setActiveNote] = useState();\n  const [cutoffValue, setCutoffValue] = useState(1);\n\n  props.midiIn &&\n    !activeNote &&\n    props.midiIn.addListener(\"noteon\", \"all\", e => {\n      console.log(\n        \"Received 'noteon' message (\" + e.note.name + e.note.octave + \").\"\n      );\n      const note = e.note.name + e.note.octave;\n      setActiveNote(note);\n    });\n\n  props.midiIn &&\n    !activeNote &&\n    props.midiIn.addListener(\"controlchange\", \"all\", e => {\n      console.log(e);\n      setCutoffValue(e.value);\n    });\n\n  useEffect(() => {\n    props.synth &&\n      props.synth.set({\n        detune: cutoffValue * 10\n      });\n  }, [cutoffValue]);\n\n  props.midiIn && props.midiIn.removeListener(\"noteoff\");\n\n  useFrame(() => {\n    mesh.current.rotation.x = mesh.current.rotation.y += 0.01;\n    mesh.current.rotation.y =\n      activeNote && activeNote.includes(props.activationNotes[0])\n        ? (mesh.current.rotation.y += 1)\n        : mesh.current.rotation.y;\n\n    mesh.current.position.z =\n      activeNote && activeNote.includes(props.activationNotes[1])\n        ? (mesh.current.position.z += 0.01)\n        : mesh.current.position.z;\n\n    mesh.current.position.z =\n      activeNote && activeNote.includes(props.activationNotes[2])\n        ? (mesh.current.position.z -= 0.01)\n        : mesh.current.position.z;\n\n    mesh.current.position.y =\n      activeNote && activeNote.includes(props.activationNotes[3])\n        ? (mesh.current.position.y -= 0.01)\n        : mesh.current.position.y;\n\n    mesh.current.position.y =\n      activeNote && activeNote.includes(props.activationNotes[4])\n        ? (mesh.current.position.y += 0.01)\n        : mesh.current.position.y;\n\n    mesh.current.position.x =\n      activeNote && activeNote.includes(props.activationNotes[5])\n        ? (mesh.current.position.x -= 0.01)\n        : mesh.current.position.x;\n\n    mesh.current.position.x =\n      activeNote && activeNote.includes(props.activationNotes[6])\n        ? (mesh.current.position.x += 0.01)\n        : mesh.current.position.x;\n\n    if (mesh.current.position.x >= 4 || mesh.current.position.x <= -4) {\n      mesh.current.position.x = 0;\n    }\n    if (mesh.current.position.y >= 4 || mesh.current.position.y <= -4) {\n      mesh.current.position.y = 0;\n    }\n    if (mesh.current.position.z >= 4 || mesh.current.position.z <= -4) {\n      mesh.current.position.z = 0;\n    }\n  });\n  const rotationY = mesh.current ? mesh.current.rotation.y / 3 : 1;\n  return (\n    <mesh\n      {...props}\n      ref={mesh}\n      scale={!active ? [(0.5 * cutoffValue) / 10, 0.5, 0.5] : [0.7, 0.7, 0.7]}\n      onClick={e => {\n        setActive(!active);\n        console.log(mesh.current.rotation.y);\n        const note = noteFromRotation(rotationY, props.notes);\n        props.synth && props.synth.triggerAttackRelease(note, 0.5);\n        props.midiOut &&\n          props.midiOut.playNote(note, \"all\", { duration: 1000 });\n      }}\n      onPointerOver={e => setHover(true)}\n      onPointerOut={e => setHover(false)}\n    >\n      <boxBufferGeometry attach=\"geometry\" args={[1, 1, 1]} />\n      <meshStandardMaterial\n        attach=\"material\"\n        color={hovered ? \"#FFFF00\" : \"#00ffff\"}\n      />\n    </mesh>\n  );\n};\n\nexport const SynthBox = withSynth(Box);\n","import React from \"react\";\nimport { Canvas } from \"react-three-fiber\";\n\nexport const ThreeDCanvas = props => {\n  return (\n    <Canvas\n      style={{\n        width: \"100vw\",\n        height: \"100vh\",\n        marginLeft: \"-200px\"\n        // borderStyle: \"solid\"\n      }}\n    >\n      <ambientLight />\n      <pointLight position={[10, 10, 10]} />\n      {props.children}\n    </Canvas>\n  );\n};\n\nexport const SmallCanvas = props => {\n  return (\n    <Canvas style={{ width: \"100%\", height: \"100%\" }}>\n      <ambientLight />\n      <pointLight position={[10, 10, 10]} />\n      {props.children}\n    </Canvas>\n  );\n};\n","import React from \"react\";\nimport { SynthBox } from \"./Box\";\nimport { ThreeDCanvas } from \"./ThreeDCanvas\";\nimport { reverse } from \"ramda\";\nexport const MidiIn = props => {\n  return (\n    <div style={{ width: \"100vh\", height: \"100vh\", alignItems: \"center\" }}>\n      <div style={{ justifyContent: \"space-between\" }}>\n        <select>\n          {props.midiIns &&\n            props.midiIns.map(input => (\n              <option\n                value={input._midiInput.id}\n                onChange={() => props.setMidiInId(input._midiInput.id)}\n              >\n                {input._midiInput.name}\n              </option>\n            ))}\n        </select>\n      </div>\n      <ThreeDCanvas>\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-3, -0.5, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[1, 0, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"])}\n          notes={reverse([\n            \"A4\",\n            \"C5\",\n            \"D3\",\n            \"E4\",\n            \"G4\",\n            \"A3\",\n            \"C4\",\n            \"D5\",\n            \"E4\",\n            \"G4\"\n          ])}\n          position={[-2, 3, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"Bb\", \"Ab\", \"D\", \"F\", \"E\", \"F\", \"G\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-3, 2, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"Bb\", \"Ab\", \"D\", \"F\", \"E\", \"F\", \"G\"])}\n          notes={reverse([\n            \"A4\",\n            \"C5\",\n            \"D3\",\n            \"E4\",\n            \"G4\",\n            \"A3\",\n            \"C4\",\n            \"D5\",\n            \"E4\",\n            \"G4\"\n          ])}\n          position={[-1, 1, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"E\", \"Gb\", \"C\", \"D\", \"B\", \"Bb\", \"Eb\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[1, -1, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"E\", \"Gb\", \"C\", \"D\", \"B\", \"Bb\", \"Eb\"])}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[1, -1, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"Eb\", \"Gb\", \"C\", \"A\", \"C\", \"D\", \"B\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-2, -1, 1]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"Eb\", \"Gb\", \"C\", \"A\", \"C\", \"D\", \"B\"])}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-2, -1, 1]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"D\", \"E\", \"C\", \"G\", \"Eb\", \"Gb\", \"C\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-3, -1, 1]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"D\", \"E\", \"C\", \"G\", \"Eb\", \"Gb\", \"C\"])}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-4, 3, 1]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"D\", \"C\", \"E\", \"Gb\", \"C\", \"G\", \"Eb\"]}\n          notes={reverse([\n            \"A4\",\n            \"C5\",\n            \"D3\",\n            \"E4\",\n            \"G4\",\n            \"A3\",\n            \"C4\",\n            \"D5\",\n            \"E4\",\n            \"G4\"\n          ])}\n          position={[-4, 3, 1]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"D\", \"E\", \"C\", \"G\", \"Eb\", \"Gb\", \"C\"])}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-4, 3, 1]}\n        />\n      </ThreeDCanvas>\n    </div>\n  );\n};\n","import React, { useState } from \"react\";\nimport { parseSong } from \"../util/songParser\";\nimport { composeMidiFile } from \"../util/composeMidiFile\";\nimport { flatten } from \"ramda\";\nimport { playMidiThroughOutput } from \"../util/playMidi\";\nimport styled from \"styled-components\";\nimport { Box } from \"./Box\";\nimport { ThreeDCanvas } from \"./ThreeDCanvas\";\n\nconst handleSubmit = ({ e, allChords, output, tempo, loop, bass }) => {\n  e.preventDefault();\n  const chords = flatten(parseSong({ chords: allChords, octave: 4, loop }));\n  const midiDataUri = composeMidiFile(chords, tempo, bass);\n  playMidiThroughOutput(midiDataUri, output);\n};\n\nconst MidiOut = props => {\n  const [chords, setChords] = useState(\"A | B | C | D\");\n  const [tempo, setTempo] = useState(160);\n  const [loop, setLoop] = useState(1);\n  const [bass, setBass] = useState(false);\n\n  const [noteBoxes, setNoteBoxes] = useState([\n    [\"A4\", \"C4\", \"D4\", \"E4\", \"G4\"],\n    [\"G4\", \"A4\", \"B4\", \"Db4\", \"Eb4\", \"F4\"],\n    [\"A5\", \"Db5\", \"Eb5\", \"E5\", \"G2\"],\n    [\"G4\", \"A4\", \"B4\", \"Db4\", \"Eb4\", \"F4\"],\n    [\"A5\", \"Db5\", \"Eb5\", \"E5\", \"G2\"]\n  ]);\n\n  console.log(props, setNoteBoxes);\n  return (\n    <>\n      <select>\n        {props.midiOuts &&\n          props.midiOuts.map(output => (\n            <option\n              value={output._midiOutput.id}\n              onChange={() => props.setMidiOutId(output._midiInput.id)}\n            >\n              {output._midiOutput.name}\n            </option>\n          ))}\n      </select>\n      <form\n        onSubmit={e =>\n          handleSubmit({\n            e,\n            allChords: chords,\n            output: props.midiOut,\n            loop,\n            tempo,\n            bass\n          })\n        }\n      >\n        <MidiText value={chords} onChange={e => setChords(e.target.value)} />\n        <input type=\"submit\" value=\"Play\" />\n      </form>\n      <div\n        style={{\n          width: \"100vh\",\n          height: \"100vh\",\n          alignItems: \"center\",\n          paddingTop: 100\n        }}\n      >\n        <Options>\n          <Text>Tempo:</Text>\n          <input\n            value={tempo}\n            type=\"number\"\n            onChange={e => {\n              setTempo(e.target.value);\n            }}\n          />\n          <Space />\n\n          <Text>Repeat:</Text>\n          <input\n            value={loop}\n            type=\"number\"\n            onChange={e => {\n              setLoop(e.target.value);\n            }}\n          />\n\n          <Space />\n          <Text>Bassline:</Text>\n          <select value={bass} onChange={e => setBass(e.target.value)}>\n            <option value={true}>{\"true\"}</option>\n            <option value={false}>{\"false\"}</option>\n          </select>\n        </Options>\n        <ThreeDCanvas style={{ width: \"100vw\", height: \"100vh\" }}>\n          {noteBoxes.map((notes, i) =>\n            i % 2 !== 0 ? (\n              <Box\n                key={i}\n                midiOut={props.midiOut}\n                notes={notes}\n                position={[-i, 0.5, 0]}\n              />\n            ) : (\n              <Box\n                key={i}\n                midiOut={props.midiOut}\n                notes={notes}\n                position={[i - 4, 2, 0]}\n              />\n            )\n          )}\n        </ThreeDCanvas>\n      </div>\n    </>\n  );\n};\n\nconst MidiText = styled.textarea`\n  font-size: 32pt;\n  font-family: Arial;\n`;\n\nconst Space = styled.div`\n  padding: 20;\n`;\nconst Text = styled.text`\n  font-size: 12pt;\n`;\n\nconst Options = styled.div`\n  justify-content: space-between;\n  flex-direction: column;\n  height: 100px;\n`;\n\nexport default MidiOut;\n","import React from \"react\";\nimport { SynthBox } from \"./Box\";\nimport { SmallCanvas } from \"./ThreeDCanvas\";\nimport styled from \"styled-components\";\n\nexport const Code = props => {\n  const rawWebMidiAPICodeBlock = `\nnavigator.requestMIDIAccess()\n  .then(onMIDISuccess);\n\nconst onMIDISuccess = (webMidiAPI) => {\n    console.log(webMidiAPI.inputs, webMidiAPI.outputs);\n    const inputs = webMidiAPI.inputs\n    inputs.map(input => {\n        input.value.onmidimessage = onMIDIMessage;\n    })\n}\n\nconst noteOn = (midiNote, velocity) => {\n    // Use a Web Audio API or library \n    // to play the note\n    // or update your UI\n    play(midiNote, velocity)\n}\n\nconst onMIDIMessage = (event) => {\n    const data = event.data,\n    const [type, note, velocity] = data,\n\n    type === 144 && noteOn(note, velocity);\n    type === 128 && noteOff(note, velocity);\n}\n\n// This project does not use the Web MIDI API directly. \n// Instead I use a bunch of libraries. This is JS afterall.\n`;\n\n  const webMidiJsCodeBlock = `\nimport WebMidi from \"webmidi\";\n\nWebMidi.enable(() => {\n\n    // Easily get inputs and outputs\n    console.log(WebMidi.inputs);\n    console.log(WebMidi.outputs);\n\n    const input = WebMidi.getInputById(\n        WebMidi.inputs[0]._midiInput.id\n    );\n\n    const output = WebMidi.getOutputById(\n        WebMidi.outputs[0]._midiOutput.id\n    );\n\n    // much easier to implement a noteon\n    input.addListener(\"noteon\", \"all\", e => {\n\n        const note = e.note.name + e.note.octave;\n\n        // Play with instrument or use the note \n        // to control a display\n        synth.triggerAttackRelease(note, 0.5);\n    });\n});\n    `;\n\n  const writingMidiFileCodeBlock = `\n  import MidiWriter from \"midi-writer-js\";\n\n  const track = new MidiWriter.Track();\n\n  // Add a BbMaj9 chord\n  new MidiWriter.NoteEvent({\n    pitch: ['Bb4', 'D5', 'A5', 'C5'],\n    duration: \"1\"\n  })\n\n  // Add as many tracks as you want\n  const midiFile = new MidiWriter.Writer([track]);\n\n  // You can use the data uri with other libraries\n  // to play back MIDI and perform any code in time with\n  // the MIDI.\n  // Or you can directly download it and play the file in your \n  // favoroite software.\n\n  midiFile.dataUri();\n  `;\n\n  const midiOutputCodeBlock = `\nimport MidiPlayer from \"midi-player-js\";\n\nconst ac = new AudioContext();\n\n  // output from previous code block\n  // this output is your synthesizer\n  // data uri from midi writer\n\n  export const playMidi = async (dataUri, output) => {\n\n    const Player = new MidiPlayer.Player(event => {\n\n      // AudioContext is important for scheduling\n      const time = ac.currentTime;\n\n      // This can be any MIDI event\n      // This is the block in which the music is played\n      event.name === \"Note on\" && output && \n            output.playNote(event.noteName, \"all\", { time })\n    });\n\n    Player.loadDataUri(dataUri);\n    Player.play();\n  };\n`;\n\n  const citations = `\nCitations and Further reading:\nhttps://webaudio.github.io/web-midi-api/\nhttps://www.keithmcmillen.com/blog/making-music-in-the-browser-web-midi-api/\nhttps://github.com/djipco/webmidi\nhttps://www.smashingmagazine.com/2018/03/web-midi-api/\nhttps://developer.mozilla.org/en-US/docs/Web/API/BaseAudioContext/currentTime\n\nOther libraries used\nReact.js\nstyled-components \nTonal (music theory) https://github.com/tonaljs/tonal\nreact-three-fiber (threejs for react) https://github.com/react-spring/react-three-fiber\nTone.js (synthesizers) https://tonejs.github.io/\n`;\n\n  return (\n    <div style={{ width: \"100vh\", height: \"100vh\", alignItems: \"center\" }}>\n      <div style={{ justifyContent: \"space-between\" }}>\n        <div style={{ padding: \"20px\" }} />\n        <CodeTitle>Web Midi API</CodeTitle>\n        <CodeSnippet>\n          <CodeText>{rawWebMidiAPICodeBlock}</CodeText>\n        </CodeSnippet>\n        <SmallCanvas>\n          <SynthBox\n            noteEvent={props.noteEvent}\n            activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n            notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n            position={[0, -0.5, 3]}\n          />\n        </SmallCanvas>\n        <CodeTitle>webmidi.js</CodeTitle>\n        <CodeSnippet>\n          <CodeText>{webMidiJsCodeBlock}</CodeText>\n        </CodeSnippet>\n        <SmallCanvas>\n          <SynthBox\n            noteEvent={props.noteEvent}\n            activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n            notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n            position={[-1.5, -0.5, 3]}\n          />\n        </SmallCanvas>\n        <CodeTitle>midiwriter.js</CodeTitle>\n        <CodeSnippet>\n          <CodeText>{writingMidiFileCodeBlock}</CodeText>\n        </CodeSnippet>\n        <SmallCanvas>\n          <SynthBox\n            noteEvent={props.noteEvent}\n            activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n            notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n            position={[2, -0.5, 3]}\n          />\n        </SmallCanvas>\n        <CodeTitle>midiplayer.js</CodeTitle>\n        <CodeSnippet>\n          <CodeText>{midiOutputCodeBlock}</CodeText>\n        </CodeSnippet>\n        <SmallCanvas>\n          <SynthBox\n            noteEvent={props.noteEvent}\n            activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n            notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n            position={[0, -0.5, 3]}\n          />\n        </SmallCanvas>\n        <div\n          style={{\n            whiteSpace: \"pre\",\n            textAlign: \"left\",\n            padding: \"50px\"\n          }}\n        >\n          {citations}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst CodeSnippet = styled.div`\n  background-color: #000000;\n  border-radius: 10px;\n  white-space: pre;\n  text-align: left;\n  padding-left: 50px;\n  padding-right: 50px;\n  padding-bottom: 50px;\n  margin-top: 30px;\n  width: 800px;\n`;\n\nconst CodeText = styled.text`\n  color: #ffffff;\n  white-space: pre;\n  text-align: left;\n`;\n\nconst CodeTitle = styled.text`\n  color: #ffffff;\n  font-size: 40pt;\n  text-align: left;\n  user-select: none;\n`;\n","import React, { useState, useEffect } from \"react\";\nimport WebMidi from \"webmidi\";\nimport { withSynth } from \"./withSynth\";\nimport { compose, length } from \"ramda\";\n\nexport const withWebMidi = Cmp => props => {\n  const [noteEvent, setNoteEvent] = useState();\n  const [midiOutId, setMidiOutId] = useState();\n  const [midiOut, setMidiOut] = useState();\n  const [midiIn, setMidiIn] = useState();\n  const [midiInId, setMidiInId] = useState();\n  const [midiOuts, setMidiOuts] = useState();\n  const [midiIns, setMidiIns] = useState();\n\n  useEffect(() => {\n    WebMidi.enable(() => {\n      console.log(WebMidi.inputs);\n      console.log(WebMidi.outputs);\n      setMidiIns(WebMidi.inputs);\n      setMidiOuts(WebMidi.outputs);\n      if (length(WebMidi.inputs) > 0 && length(WebMidi.outputs) > 0) {\n        const input = WebMidi.getInputById(\n          midiInId || WebMidi.inputs[1]._midiInput.id\n        );\n        // const output = WebMidi.getOutputById(\"1295864820\");\n        const output = WebMidi.getOutputById(\n          midiOutId || WebMidi.outputs[1]._midiOutput.id\n        );\n\n        setMidiOut(output);\n        setMidiIn(input);\n        // input.addListener(\"noteon\", \"all\", e => {\n        //   console.log(\n        //     \"Received 'noteon' message (\" + e.note.name + e.note.octave + \").\"\n        //   );\n        //   const note = e.note.name + e.note.octave;\n        //   setNoteEvent(note);\n        //   props.synth.triggerAttackRelease(note, 0.5);\n        // });\n        // input.removeListener(\"noteoff\");\n      }\n    });\n  }, [midiOutId, midiInId, midiIns, midiOuts]);\n\n  return (\n    <Cmp\n      noteEvent={noteEvent}\n      midiOuts={midiOuts}\n      setMidiOutId={setMidiOutId}\n      midiIns={midiIns}\n      setMidiInId={setMidiInId}\n      midiOut={midiOut}\n      midiIn={midiIn}\n      {...props}\n    >\n      {props.children}\n    </Cmp>\n  );\n};\n\nexport const withMidi = compose(withSynth, withWebMidi);\n","import React from \"react\";\n\nimport { HashRouter as Router, Switch, Route, Link } from \"react-router-dom\";\nimport Fakebook from \"./components/Fakebook\";\nimport { MidiIn } from \"./components/MidiIn\";\nimport MidiOut from \"./components/MidiOut\";\nimport { Code } from \"./components/Code\";\nimport { withMidi } from \"./util/withMidi\";\nimport styled from \"styled-components\";\n\nexport const Routes = props => {\n  return (\n    <Router basename={\"/\"}>\n      <div style={{ flexDirection: \"row\" }}>\n        <SideNav>\n          <div>\n            <Link to=\"/fakebook\">Jazzbot</Link>\n          </div>\n          <div>\n            <Link to=\"/midi-in\">midi-in</Link>\n          </div>\n          <div>\n            <Link to=\"/midi-out\">midi-out</Link>\n          </div>\n          <div>\n            <Link to=\"/code\">code</Link>\n          </div>\n          {/* <Link to=\"/midi-chat\">midi-chat</Link> */}\n        </SideNav>\n        <Switch>\n          <Route path=\"/fakebook\">\n            <Fakebook />\n          </Route>\n          <Route path=\"/midi-in\">\n            <MidiIn {...props} />\n          </Route>\n          <Route path=\"/midi-out\">\n            <MidiOut {...props} />\n          </Route>\n          <Route path=\"/code\">\n            <Code {...props} />\n          </Route>\n          <Route path=\"/\" component={Fakebook}></Route>\n        </Switch>\n      </div>\n    </Router>\n  );\n};\n\nconst SideNav = styled.div`\n  height: 100%;\n  width: 50;\n  left: 0;\n  z-index: 20;\n  position: fixed;\n  flex: 1;\n  background-color: #ff00ff;\n  justify-content: left;\n`;\n\nexport default withMidi(Routes);\n","import React from \"react\";\nimport \"./App.css\";\nimport Routes from \"./Routes\";\n\nconst App = () => {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <Routes />\n      </header>\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}